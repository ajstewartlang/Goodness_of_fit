---
title: "Goodness of fit study - Truth as Predictor of Reading Times"
author: "Andrew Stewart"
date: "04/05/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(psych)
library(lme4)
library(lmerTest)
library(emmeans)
library(performance)
```

First is Igor's code:

```{r, message=FALSE}
dataT <- read_csv("Explanation_TRUTH.csv")
dataT <- dataT[3:nrow(dataT),]
#nrow(dataT) # 158

dat0T <- filter(dataT, Finished == 1)
nrow(dat0T) # 144
datT <- filter(dat0T, check == "7" & serious == "1" & UserLanguage == "EN")
#nrow(datT) # 138

# time (in secs) spent on survey
describe(as.numeric(as.data.frame(datT)[,6]))

# gender
table(datT$Gender)

# age
describe(as.numeric(datT$Age))

# mean responses
resT <- sapply(23:58, function(x) mean(as.numeric(as.data.frame(datT)[,x]), na.rm = T))

# in the survey, we interchanged strong and weak explanations in the two groups
strongT <- resT[c(seq(1, 17, 2), seq(20, 36, 2))]
weakT <- resT[c(seq(2, 18, 2), seq(19, 35, 2))]

resultsT <- c(strongT, weakT)
```

# Andrew's code to tidy the df so we can combine it with the eye-tracking data.

```{r, message=FALSE}
#Truth ####
summary <- datT %>% 
  pivot_longer(cols = colnames(datT)[23:58], names_to = "Item", values_to = "Score") %>%
  select(Item, Score) %>%
  mutate(Item = factor(Item),
         Score = as.integer(Score)) %>%
  filter(!is.na(Score)) %>%
  group_by(Item) %>%
  summarise(mean_score = mean(Score)) 

summary$Item <- str_replace(summary$Item, "A_", "_A-")
summary$Item <- str_replace(summary$Item, "B_", "_B-")

summary <- summary %>%
  separate(col = Item, into = c("Item", "Condition"), sep = "_") 

summary$Condition <- str_replace(summary$Condition, "A-acceptance", "High")
summary$Condition <- str_replace(summary$Condition, "B-acceptance", "Low")

ready_to_combine <- summary %>%
  unite(col = "Item_Condition", c(Item, Condition), sep="_")
```

Read in the eye tracking data and combine it with our MTurk ratings data.

# First Pass
```{r}
first_pass <- read_csv("eye_data/FPs_plus_ratings.csv") %>%
  unite(col = "Item_Condition", c(Item, Fit), sep="_")

# Join the rating and eye-tracking data
joined_data_fp <- left_join(first_pass, ready_to_combine, by = "Item_Condition") %>%
  separate(col = "Item_Condition", into = (c("Item", "Condition")), sep = "_") %>%
  mutate(Condition = factor(Condition))
```

## Antecedent
```{r, message=FALSE, warning=FALSE}
model_antecedent <- lmer(Antecedent ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_fp)
summary(model_antecedent)
#check_model(model_antecedent)
```

No effect.

## Consequent
```{r}
model_consequent<- lmer(Consequent ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_fp)
summary(model_consequent)
#check_model(model_consequent)
```

No effect.

## Spillover
```{r}
model_spillover <- lmer(spillover ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_fp)
summary(model_spillover)
#check_model(model_spillover)
```

No effect.

# Regression Path
```{r, message=FALSE, warning=FALSE}
regression_path <- read_csv("eye_data/RPs_plus_ratings.csv") %>%
  unite(col = "Item_Condition", c(Item, Fit), sep="_")

# Join the rating and eye-tracking data
joined_data_rp <- left_join(regression_path , ready_to_combine, by = "Item_Condition") %>%
  separate(col = "Item_Condition", into = (c("Item", "Condition")), sep = "_") %>%
  mutate(Condition = factor(Condition))
```

## Antecedent
```{r}
model_antecedent <- lmer(Antecedent ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_rp)
summary(model_antecedent)
#check_model(model_antecedent)
```

No effect.

## Consequent
```{r}
model_consequent<- lmer(Consequent ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_rp)
summary(model_consequent)
#check_model(model_consequent)
```

Nice effect - as truth rating goes up, reading time goes down

## Spillover
```{r}
model_spillover <- lmer(spillover ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_rp)
summary(model_spillover)
#check_model(model_spillover)
```

Hint of a carry over effect (same as above.)

# Total Time
```{r, message=FALSE, warning=FALSE}
total_time <- read_csv("eye_data/TTs_plus_ratings.csv") %>%
  unite(col = "Item_Condition", c(Item, Fit), sep="_")

# Join the rating and eye-tracking data
joined_data_tt <- left_join(total_time , ready_to_combine, by = "Item_Condition") %>%
  separate(col = "Item_Condition", into = (c("Item", "Condition")), sep = "_") %>%
  mutate(Condition = factor(Condition))
```

## Antecedent
```{r}
model_antecedent <- lmer(Antecedent ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_tt)
summary(model_antecedent)
#check_model(model_antecedent)
```

No effect - but pattern same as previous.

## Consequent
```{r}
model_consequent<- lmer(Consequent ~ mean_score + (1 | P.s) , data = joined_data_tt)
summary(model_consequent)
#check_model(model_consequent)
```

No effect.

## Spillover
```{r}
model_spillover <- lmer(spillover ~ mean_score + (1 | P.s) + (1 | Item), data = joined_data_tt)
summary(model_spillover)
#check_model(model_spillover)
```

No effect.
